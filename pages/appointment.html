<!--This is not a independent page-->
<!--It will be add in to a <div> element-->
<!--no need to start with <!DOCTYPE html> <html> <head> <body> tags-->
<style>
    .appointment-page {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 48px;
        height: 100%;
    }

    .appointment-page h1 {
        font-size: 36px;
        margin-bottom: 20px;
        text-align: center;
    }
</style>
<div class="appointment-page usingFormDefaultStyle">
    <div class="form-container">
        <h1 id="form-title">服務預約與線上報價</h1>
        <form id="appointment-form" action="#payment" method="get" class="usingFormDefaultStyle">
            <!-- 動態生成欄位 -->
            <div id="form-fields"></div>
            <button type="submit" class="form-submit-button">提交並前往付款</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const hash = window.location.hash;
        let service = null;
        if (hash.includes('?')) {
            const params = new URLSearchParams(hash.split('?')[1]);
            service = params.get('service');
        }

        if (service) {
            fetch('services_form.json')
                .then(res => res.json())
                .then(data => {
                    const config = data[service];
                    if (!config) {
                        document.getElementById('form-fields').innerHTML = '<p>找不到對應的服務設定。</p>';
                        return;
                    }

                    // 設定標題
                    document.getElementById('form-title').textContent = config.title;

                    // 動態生成欄位
                    const container = document.getElementById('form-fields');
                    container.innerHTML = '';
                    config.fields.forEach(field => {
                        let html = '';
                        if (field.type === 'select') {
                            html = `<label class="form-label">${field.label}</label>
                                <select class="form-select" name="${field.name}" ${field.required ? 'required' : ''}>
                                    ${field.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                                </select>`;
                        } else if (field.type === 'textarea') {
                            html = `<label class="form-label">${field.label}</label>
                                <textarea class="form-textarea" name="${field.name}"></textarea>`;
                        } else {
                            html = `<label class="form-label">${field.label}</label>
                                <input type="${field.type}" class="form-input" name="${field.name}" ${field.required ? 'required' : ''}>`;
                        }
                        const div = document.createElement('div');
                        div.className = 'form-input-group';
                        div.innerHTML = html;
                        container.appendChild(div);
                    });
                });
        }
    });
</script>